<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>连接钱包登录</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="login-box">
    <h2>请连接钱包登录</h2>
    <button onclick="connectWallet()">连接钱包</button>
    <p id="status">未连接</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    async function connectWallet(){
      if(window.ethereum){
        try{
          const provider = new ethers.providers.Web3Provider(window.ethereum);
          await provider.send("eth_requestAccounts", []);
          const signer = provider.getSigner();
          const addr = await signer.getAddress();
          document.getElementById("status").innerText = "✅ 已连接: " + addr;
          localStorage.setItem("walletAddress", addr);
          setTimeout(()=>{ window.location.href="home.html"; },1000);
        }catch(err){
          document.getElementById("status").innerText = "❌ 连接失败: " + err.message;
        }
      }else{
        alert("请先安装 MetaMask 或 Oky 钱包");
      }
    }
  </script>
</body>
</html>
